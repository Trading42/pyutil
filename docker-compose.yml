version: '3.4'
services:
  pyutil:
     build:
       context: .
       dockerfile: Dockerfile
       target: test
     volumes:
        - ./pyutil:/pyutil/pyutil
        - ./sandbox:/pyutil/sandbox
     extra_hosts:
        # obviously you can not access
        - quantsrv:192.168.100.15
     env_file:
       - .env
     volumes:
        -  /etc/localtime:/etc/localtime:ro
     links:
       - test-postgresql
       - test-influxdb

  test-postgresql:
    image: postgres:9.6
    environment:
      POSTGRES_PASSWORD: "test"

  test-influxdb:
    image: influxdb