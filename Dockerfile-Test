# Set the base image to Ubuntu
FROM continuumio/miniconda3

RUN conda install -y python=3.6 pandas=0.21 requests

COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt && rm requirements.txt

# this is used to mock http for testing
RUN pip install httpretty pytest pytest-cov pytest-html sphinx

ADD ./pyutil          /pyutil/pyutil
ADD ./test            /pyutil/test

RUN mkdir -p /html-coverage
RUN mkdir -p /html-report

WORKDIR pyutil

CMD py.test --cov=pyutil  --cov-report html:/html-coverage --cov-report term --html=/html-report/report.html test
